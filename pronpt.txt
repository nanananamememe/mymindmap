# マインドマップアプリケーション 作成のためのプロンプト

【アプリ概要】
このアプリケーションは、思考や概念を視覚的に整理するためのシンプルなマインドマップツールです。  
中央に初期ノードを配置し、ユーザーがノードをクリックすると、そのノードから右側へ子ノードが生成され、  
親子関係は接続線（SVGのpath要素）で表現されます。ドラッグ操作でノード位置を自由に変更でき、  
移動に合わせて接続線も自動更新されます。

【HTML構造】
- ページ全体に配置された <svg id="mindmap"> 要素により、ノード間の接続線を描画します。
- ノードは div 要素として生成され、その内部にテキスト編集用の span 要素が含まれます。
- 初期ノードは生成時に削除ボタンを持たず、子ノードのみ削除ボタン（右上に丸で囲んだ×印）が付与されます。

【CSS仕様】
- 背景色: 薄いグレー (#f0f0f0)
- ノード (.node):
  - サイズ: 幅150px、高さ80px
  - 背景: 薄いグレー (#eeeeee)
  - 枠線: 黒い境界線、角丸 (border-radius: 10px)
  - 中央揃え (display: flex, align-items: center, justify-content: center)
  - 絶対配置
  - z-index を設定し、svg の接続線より前面に表示
- ノード内テキスト (.node-text):
  - ノードの70%幅、60%高さ
  - 角丸 (border-radius: 6px)、パディング5px
  - 編集中は点線境界と薄いグレーの背景 (#f8f8f8)
- 接続線 (.connection):
  - SVGのpath要素として描画
  - 黒色のストローク、線幅2px
- 削除ボタン (.node-delete):
  - 初期ノードには不要。子ノードは右上に配置
  - サイズ: 20px×20px
  - 背景色: #aaa、文字色: 白
  - 丸形 (border-radius: 50%)
  - 要素内の×印は display: flex で中央揃え
  - カーソルは pointer

【JavaScript機能】
■ 初期化：
- ページ読み込み時に、画面中央に初期ノード（削除ボタンなし）を作成する。

■ ノード作成：
- createNode() 関数で新規ノードを生成する。
  - 引数に delete ボタンの付与可否（初期ノードは false、子ノードは true）を指定可能。
  - ノード内の span 要素は contenteditable="true" によりテキスト編集を可能にする。
- ノードの背景部分（テキスト以外）をクリックすると、
  - ドラッグでなければ、クリックされたノードの右側に子ノードを生成する。
  - 子ノード生成時に、生成元と子ノードの接続線を addConnection() で描画する。

■ 削除機能：
- 各子ノードには、右上に削除ボタン (.node-delete) を表示する。
- 削除ボタンのクリックイベントで、該当ノードとその接続線を removeNode() 関数により削除する。

■ ドラッグ機能：
- ノードの mousedown イベントでドラッグ開始し、mousemove で位置更新、mouseup で終了する。
- 一定以上のマウス移動があった場合は、クリックイベントとして新規子ノード生成をキャンセルする仕組みを実装する。

■ 接続線描画：
- ノード間の親子関係は、SVGの <path> 要素でベジェ曲線を利用して描画する。
- updateConnections() 関数で、各ノードの位置に応じた接続線の path の d 属性を更新する。
  - 接続位置は、子ノードが親ノードの右側にあれば、親の右端・子の左端の中央位置、  
    それ以外の場合は、親ノードの左端と子ノードの右端の中央位置を利用する。

■ イベント管理：
- テキスト編集とノード操作（ドラッグ、新規生成）でイベントの伝播を適切に制御する。

【まとめ】
・index.html、styles.css、app.js の各ファイルに上記内容に基づいて実装を行ってください。  
・index.html は <svg id="mindmap"> 要素を配置し、ページ全体の構造を構築します。  
・styles.css には、ノード、接続線、削除ボタンに対するスタイルを定義してください。  
・app.js では、初期ノード生成、子ノード生成、ドラッグ操作、接続線更新、削除機能などを実装してください。

このプロンプトを元に、各ファイルを一発で実装できるコードスキャフォールディングを行ってください。
